# 项目2：打靶法与scipy.solve_bvp求解边值问题

## 项目背景

边值问题（Boundary Value Problem, BVP）是微分方程理论中的重要组成部分，在物理学、工程学等领域有广泛应用。本项目将通过求解一个具体的二阶线性常微分方程边值问题，学习和比较两种重要的数值求解方法：**打靶法（Shooting Method）**和**scipy.integrate.solve_bvp**函数。

我们要解决的问题是：
$$u''(x) = -\frac{\pi(u(x)+1)}{4}$$
边界条件：$u(0) = 1$，$u(1) = 1$

## 学习目标

通过完成本项目，你将能够：

1. **理解打靶法的基本原理**：掌握如何将边值问题转化为初值问题，通过调整初始条件来满足边界条件
2. **掌握scipy.solve_bvp的使用**：学会如何定义ODE系统函数和边界条件函数
3. **比较不同方法的特点**：分析两种方法在精度、收敛性和计算效率方面的差异
4. **提升数值计算技能**：加深对边值问题数值解法的理解

## 任务列表

### 任务1：实现打靶法求解器 (40分)

实现函数 `solve_bvp_shooting_method(x_span, boundary_conditions, n_points=100, max_iterations=10, tolerance=1e-6)`

**功能要求：**
- 使用打靶法求解给定的边值问题
- 通过迭代调整初始斜率来满足右边界条件
- 使用线性插值或割线法进行迭代优化
- 返回解的x坐标数组和对应的y值数组

**算法提示：**
1. 将二阶ODE转化为一阶ODE系统
2. 设定初始猜测的斜率值
3. 使用odeint或solve_ivp求解初值问题
4. 检查右边界条件是否满足
5. 如不满足，使用数值方法调整初始斜率
6. 重复直到收敛或达到最大迭代次数

### 任务2：实现ODE系统函数 (15分)

实现函数 `ode_system_shooting(t, y)`

**功能要求：**
- 将二阶ODE $u'' = -\frac{\pi(u+1)}{4}$ 转化为一阶ODE系统
- 返回导数向量 $[y_1', y_2']$，其中 $y_1 = u$，$y_2 = u'$

### 任务3：实现scipy.solve_bvp封装函数 (25分)

实现函数 `solve_bvp_scipy_wrapper(x_span, boundary_conditions, n_points=50)`

**功能要求：**
- 使用scipy.integrate.solve_bvp求解边值问题
- 定义适当的ODE系统函数和边界条件函数
- 设置合理的初始猜测
- 返回解的x坐标数组和对应的y值数组

### 任务4：实现边界条件函数 (10分)

实现函数 `boundary_conditions_scipy(ya, yb)`

**功能要求：**
- 定义边界条件：$u(0) = 1$，$u(1) = 1$
- 返回边界条件残差数组

### 任务5：结果比较与可视化 (10分)

实现函数 `compare_methods_and_plot(x_span, boundary_conditions)`

**功能要求：**
- 调用两种方法求解同一问题
- 生成对比图表，显示两种方法的解
- 计算并显示解之间的差异
- 图表标题、轴标签、图例必须使用英文

## 技术要求

### 必需的Python库
```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import odeint, solve_ivp, solve_bvp
from scipy.optimize import fsolve
```

### 数值精度要求
- 默认容差：1e-6
- 浮点数比较使用适当的容差
- 确保数值稳定性

### 代码质量要求
- 遵循PEP 8编码规范
- 包含详细的英文docstrings
- 适当的错误处理和参数验证
- 使用numpy向量化操作提高效率

## 提示与资源

### 打靶法算法伪代码
```
1. 设定初始猜测斜率 m1
2. 用 (u(0)=1, u'(0)=m1) 作为初始条件求解IVP
3. 检查 u(1) 是否等于 1（在容差范围内）
4. 如果不满足：
   a. 设定新的猜测斜率 m2
   b. 用 (u(0)=1, u'(0)=m2) 求解IVP
   c. 使用线性插值或割线法计算更好的斜率猜测
5. 重复直到收敛
```

### 关键数学公式
- 原方程：$u''(x) = -\frac{\pi(u(x)+1)}{4}$
- 一阶系统：$y_1' = y_2$，$y_2' = -\frac{\pi(y_1+1)}{4}$
- 边界条件：$u(0) = 1$，$u(1) = 1$

### 调试提示
- 检查ODE系统函数的参数顺序（注意solve_bvp使用(x,y)而odeint使用(y,t)）
- 确保边界条件函数返回正确维度的数组
- 打靶法的初始斜率猜测对收敛性很重要
- 使用matplotlib验证中间结果

## 评分标准

| 任务 | 分数 | 评分要点 |
|------|------|----------|
| 任务1：打靶法实现 | 40分 | 算法正确性(20分)、收敛性(10分)、代码质量(10分) |
| 任务2：ODE系统函数 | 15分 | 数学转换正确性(10分)、函数接口(5分) |
| 任务3：solve_bvp封装 | 25分 | 函数使用正确性(15分)、参数设置(5分)、结果处理(5分) |
| 任务4：边界条件函数 | 10分 | 边界条件定义正确性(7分)、返回格式(3分) |
| 任务5：比较与可视化 | 10分 | 图表质量(5分)、结果分析(3分)、英文标注(2分) |

**总分：100分**

## 提交要求

1. **代码文件**：完成 `shooting_method_student.py` 中的所有函数实现
2. **实验报告**：按照提供的模板完成实验报告
3. **测试验证**：确保代码通过所有单元测试
4. **图表要求**：所有图表的标题、轴标签、图例必须使用英文

## 截止日期

请在 **[DEADLINE_DATE]** 前提交完整的项目文件。

---

**注意事项：**
- 本项目重点考查对不同BVP求解方法的理解和实现能力
- 鼓励对比分析两种方法的优缺点
- 如遇到收敛问题，可尝试调整初始猜测或迭代参数
- 学术诚信：独立完成，可参考资料但需注明来源